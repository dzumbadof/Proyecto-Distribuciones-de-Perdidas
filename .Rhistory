aportes <- aportes + 0.45*( PM$MON_PEN[k] - 37267750)
}else if( PM$MON_PEN[k] >= 46584688 &  PM$MON_PEN[k] <  58230859 ){
aportes <- aportes + 0.55*( PM$MON_PEN[k] - 46584688 )
}else if( PM$MON_PEN[k] >= 58230859 ){
aportes <- aportes + 0.65*( PM$MON_PEN[k] - 58230859 )
}
}
aportes <- aportes + 0.1*( sum(PH$MON_PEN) + sum(PH$MON_PEN) + sum(TJH$MON_PEN) +
sum(TJM$MON_PEN) )
(Prima_mediaL <- (costo_LiquidacionT - aportes)/masa_salarialL)
currency(aportes, digits=0L, symbol = "")
View(LH)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(lifecontingencies)
library(lubridate)
library(dplyr)
library(formattable)
#a: antiguedad
#k: Cantidad de a単os en el futuro que ocurre el siniestr
#S: salario anual de hoy
#r: tasa de crecimiento nominal del salario
S <- function(a, k, S, r){
x <- S*((1+r)^k + (1+pi)*(1+r)^(k-1) + (1+pi)^2*(1+r)^(k-2) +
(1+pi)^3*(1+r)^(k-3) + (1+pi)^4*(1+r)^(k-4))/5
#x <- S*( sum((1+r)^(10 - 0:9)*(1+pi)^(0:9)) )/10
if(a < 5){
x <- 0
}else if(a < 10){
x <- 0.05*x
}else if(a < 15){
x <- 0.125*x
} else if(a < 20){
x <- 0.17*x
}else if(a < 25){
x <- 0.21*x
}else if(a < 30){
x <- 0.27*x
}else if(a < 35){
x <- 0.335*x
}else{
x <- 0.385*x
}
return(x*13/12)
}
S(10, 5, 1000, n)
#a: antiguedad
#k: Cantidad de a単os en el futuro que ocurre el siniestr
#S: salario anual de hoy
#r: tasa de crecimiento nominal del salario
S <- function(a, k, S, r){
# x <- S*((1+r)^k + (1+pi)*(1+r)^(k-1) + (1+pi)^2*(1+r)^(k-2) +
#(1+pi)^3*(1+r)^(k-3) + (1+pi)^4*(1+r)^(k-4))/5
x <- S*( sum((1+r)^(10 - 0:9)*(1+pi)^(0:9)) )/10
if(a < 5){
x <- 0
}else if(a < 10){
x <- 0.05*x
}else if(a < 15){
x <- 0.125*x
} else if(a < 20){
x <- 0.17*x
}else if(a < 25){
x <- 0.21*x
}else if(a < 30){
x <- 0.27*x
}else if(a < 35){
x <- 0.335*x
}else{
x <- 0.385*x
}
return(x*13/12)
}
S(10, 5, 1000, n)
#172.319
10 - 0:9
#a: antiguedad
#k: Cantidad de a単os en el futuro que ocurre el siniestr
#S: salario anual de hoy
#r: tasa de crecimiento nominal del salario
S <- function(a, k, S, r){
# x <- S*((1+r)^k + (1+pi)*(1+r)^(k-1) + (1+pi)^2*(1+r)^(k-2) +
#(1+pi)^3*(1+r)^(k-3) + (1+pi)^4*(1+r)^(k-4))/5
x <- S*( sum((1+r)^(k - 0:9)*(1+pi)^(0:9)) )/10
if(a < 5){
x <- 0
}else if(a < 10){
x <- 0.05*x
}else if(a < 15){
x <- 0.125*x
} else if(a < 20){
x <- 0.17*x
}else if(a < 25){
x <- 0.21*x
}else if(a < 30){
x <- 0.27*x
}else if(a < 35){
x <- 0.335*x
}else{
x <- 0.385*x
}
return(x*13/12)
}
S(10, 5, 1000, n)
#172.319
#a: antiguedad
#k: Cantidad de a単os en el futuro que ocurre el siniestr
#S: salario anual de hoy
#r: tasa de crecimiento nominal del salario
S <- function(a, k, S, r){
# x <- S*((1+r)^k + (1+pi)*(1+r)^(k-1) + (1+pi)^2*(1+r)^(k-2) +
#(1+pi)^3*(1+r)^(k-3) + (1+pi)^4*(1+r)^(k-4))/5
x <- S*( sum((1+r)^(k - 0:9)*(1+pi)^(0:9)) )/10
if(a < 5){
x <- 0
}else if(a < 10){
x <- 0.05*x
}else if(a < 15){
x <- 0.125*x
} else if(a < 20){
x <- 0.17*x
}else if(a < 25){
x <- 0.21*x
}else if(a < 30){
x <- 0.27*x
}else if(a < 35){
x <- 0.335*x
}else{
x <- 0.385*x
}
return(x*13/12)
}
muerte <- c()
for(k in 1:length(LH$Sexo)){
costo <- 0
for(j in 1:(86 - LH$EDAD_ENTERA[k])){
costo <- costo + S(LH$Antiguedad[k], j, LH$Salario[k], n)*
pxt(TablaMD_H, LH$EDAD_ENTERA[k], j)*
qxt(TablaMD_H, LH$EDAD_ENTERA[k]+j, 1, decrement = 4)*v^j*
annuity(i_star, 10, m=0, k=12,type = "immediate")
}
muerte[k] <- 0.2*costo
}
LH$muerte <- muerte
currency(sum(LH$muerte), digits=0L, symbol = "")
invalidez <- c()
for(k in 1:length(LH$Sexo)){
costo <- 0
for(j in 1:(86 - LH$EDAD_ENTERA[k])){
costo <- costo + S(LH$Antiguedad[k], j, LH$Salario[k], n)*
pxt(TablaMD_H, LH$EDAD_ENTERA[k], j)*
qxt(TablaMD_H, LH$EDAD_ENTERA[k]+j, 1, decrement = 1)*v^j*
axn(lfH, x=LH$EDAD_ENTERA[k] + j, i = i_star, k = 12, payment="advance")
}
invalidez[k] <- 0.6*costo
}
LH$invalidez <- invalidez
currency(sum(LH$invalidez), digits=0L, symbol = "")
retiro <- c()
#Segun la tabla la edad de 86 es la maxima de retiro
for(k in 1:length(LH$Sexo)){
costo <- 0
for(j in 1:(86 - LH$EDAD_ENTERA[k])){
costo <- costo + S(LH$Antiguedad[k], j, LH$Salario[k], n)*
pxt(TablaMD_H, LH$EDAD_ENTERA[k], j)*v^j*
qxt(TablaMD_H, LH$EDAD_ENTERA[k]+j, 1, decrement = 2)*
axn(lfH, x=LH$EDAD_ENTERA[k] + j, i = i_star, k = 12, payment="advance")
}
retiro[k] <- costo
}
LH$retiro <- retiro
currency(sum(LH$retiro), digits=0L, symbol = "")
LH <- LH %>% mutate(beneficio = muerte + retiro + invalidez)
currency(sum(LH$beneficio), digits=0L, symbol = "")
View(LH)
LH <- LH %>% mutate( salirse = liquidacion > beneficio)
LH <- LH %>% mutate( salirse = as.numeric(liquidacion > beneficio))
sum(salirse)
sum(LH$salirse)
LH %>% group_by(salirse) %>% summarise( promedio = mean(Antiguedad))
LH %>% group_by(salirse) %>% summarise( promedio_A = mean(Antiguedad),
promedio_S = mean(Salario))
library(ggplot2)
LH %>% group_by(salirse) %>% ggplot(aes(x=Salirse, y=Antiguedad)) +
geom_bar(stat = "identity")
LH %>% group_by(salirse) %>% ggplot(aes(x=salirse, y=Antiguedad)) +
geom_bar(stat = "identity")
LH %>% ggplot(aes(x=salirse, y=Antiguedad)) +
geom_bar(stat = "identity")
LH %>% ggplot(aes(x=Antiguedad)) +
geom_bar(stat = "identity")
LH %>% ggplot(aes(x=Antiguedad, color=salirse)) +
geom_bar(stat = "identity")
LH %>% ggplot(aes(x=as.factor(Antiguedad), color=salirse)) +
geom_bar(stat = "identity")
LH %>% ggplot(aes(Antiguedad, color=salirse)) +
geom_bar(stat = "identity")
LH %>% ggplot(aes(Antiguedad, color=`salirse`)) +
geom_bar(stat = "identity")
ggplot(LH) + geom_bar(aes(Antiguedad))
ggplot(LH) + geom_bar(aes(Antiguedad, color = salirse))
ggplot(LH) + geom_bar(aes(Antiguedad, fill = salirse))
ggplot(LH) + geom_bar(aes(Antiguedad, fill = as.factor(salirse)))
ggplot(LH) + geom_bar(aes(Antiguedad, fill = as.factor(salirse))) +
theme(legend.text = 'salirse')
ggplot(LH) + geom_bar(aes(Antiguedad, fill = as.factor(salirse))) +
labs(x = "Antiguedad", y = "", fill = "Liquidar")
ggplot(LH) + geom_bar(aes(Antiguedad, fill = as.factor(salirse))) +
labs(x = "Antiguedad", y = "", fill = "Liquidar")+
theme_minimal()
LH <- LH %>% mutate( salirse = as.numeric(liquidacion >= beneficio))
ggplot(LH) + geom_bar(aes(Antiguedad, fill = as.factor(salirse))) +
labs(x = "Antiguedad", y = "", fill = "Liquidar")+
theme_minimal()
ggplot(LH) + geom_bar(aes(Salario, fill = as.factor(salirse))) +
labs(x = "Antiguedad", y = "", fill = "Liquidar")+
theme_minimal()
ggplot(LH) + geom_point(aes(Salario, fill = as.factor(salirse))) +
labs(x = "Antiguedad", y = "", fill = "Liquidar")+
theme_minimal()
ggplot(LH, aes(x = Identificador, y = Salario, color = salirse) + geom_point()
ggplot(LH, aes(x = Identificador, y = Salario, color = factor(salirse)) + geom_point()
ggplot(LH, aes(x = Identificador, y = Salario)) +
geom_point(aes(color = factor(salise)))
ggplot(LH, aes(x = Identificador, y = Salario)) +
geom_point(aes(color = factor(salirse)))
ggplot(LH, aes(x = Identificador, y = Salario)) +
geom_point(aes(color = factor(salirse)))+
theme_minimal()
ggplot(LH, aes(x = Identificador, y = Salario)) +
geom_point(aes(color = factor(salirse)))+
labs(x = "", y = "Salario", color = "Liquidar")+
theme_minimal()
ggplot(LH, aes(x = Identificador, y = Salario)) +
geom_point(aes(color = factor(salirse)))+
labs(x = "Identificador", y = "Salario", color = "Liquidar")+
theme_minimal()
muerte <- c()
for(k in 1:length(LM$Sexo)){
costo <- 0
for(j in 1:(78 - LM$EDAD_ENTERA[k])){
costo <- costo + S(LM$Antiguedad[k], j, LM$Salario[k], n)*
pxt(TablaMD_M, LM$EDAD_ENTERA[k], j)*
qxt(TablaMD_M, LM$EDAD_ENTERA[k]+j, 1, decrement = 4)*v^j*
annuity(i_star, 10, m=0, k=12,type = "immediate")
}
muerte[k] <- 0.2*costo
}
LM$muerte <- muerte
currency(sum(LM$muerte), digits=0L, symbol = "")
invalidez <- c()
for(k in 1:length(LM$Sexo)){
costo <- 0
for(j in 1:(78 - LM$EDAD_ENTERA[k])){
costo <- costo + S(LM$Antiguedad[k], j, LM$Salario[k], n)*
pxt(TablaMD_M, LM$EDAD_ENTERA[k], j)*
qxt(TablaMD_M, LM$EDAD_ENTERA[k]+j, 1, decrement = 1)*v^j*
axn(lfM, x=LM$EDAD_ENTERA[k] + j, i = i_star, k = 12, payment="advance")
}
invalidez[k] <- 0.6*costo
}
LM$invalidez <- invalidez
currency(sum(LM$invalidez), digits=0L, symbol = "")
retiro <- c()
#Segun la tabla la edad de 86 es la maxima de retiro
for(k in 1:length(LM$Sexo)){
costo <- 0
for(j in 1:(78 - LM$EDAD_ENTERA[k])){
costo <- costo + S(LM$Antiguedad[k], j, LM$Salario[k], n)*
pxt(TablaMD_M, LM$EDAD_ENTERA[k], j)*v^j*
qxt(TablaMD_M, LM$EDAD_ENTERA[k]+j, 1, decrement = 2)*
axn(lfM, x=LM$EDAD_ENTERA[k] + j, i = i_star, k = 12, payment="advance")
}
retiro[k] <- costo
}
LM$retiro <- retiro
currency(sum(LM$retiro), digits=0L, symbol = "")
LM <- LM %>% mutate(beneficio = muerte + retiro + invalidez)
currency(sum(LM$beneficio), digits=0L, symbol = "")
ggplot(LM) + geom_bar(aes(Antiguedad, fill = as.factor(salirse))) +
labs(x = "Antiguedad", y = "", fill = "Liquidar")+
theme_minimal()
LM <- LM %>% mutate( salirse = as.numeric(liquidacion >= beneficio))
ggplot(LM) + geom_bar(aes(Antiguedad, fill = as.factor(salirse))) +
labs(x = "Antiguedad", y = "", fill = "Liquidar")+
theme_minimal()
ggplot(LM, aes(x = Identificador, y = Salario)) +
geom_point(aes(color = factor(salirse)))+
labs(x = "Identificador", y = "Salario", color = "Liquidar")+
theme_minimal()
costo_total_nuevo <- sum(LH$beneficio) + sum(LM$beneficio)
currency(costo_total_nuevo, digits=0L, symbol = "")
(prima_media <- (costo_total_nuevo + costoJ)/masa_salarialT)
h <- 7
w <- h*1.6
ggplot(LH) + geom_bar(aes(Antiguedad, fill = as.factor(salirse))) +
labs(x = "Antiguedad", y = "", fill = "Liquidar")+
theme_minimal()
ggsave(filename = "antiguedadH", width = w, height = h)
ggsave(filename = "antiguedadH", width = w, height = h)
ggsave(filename = "antiguedadH.pdf", width = w, height = h)
ggplot(LH, aes(x = Identificador, y = Salario)) +
geom_point(aes(color = factor(salirse)))+
labs(x = "Identificador", y = "Salario", color = "Liquidar")+
theme_minimal()
ggsave(filename = "SalarioH.pdf", width = w, height = h)
ggplot(LM) + geom_bar(aes(Antiguedad, fill = as.factor(salirse))) +
labs(x = "Antiguedad", y = "", fill = "Liquidar")+
theme_minimal()
ggsave(filename = "AntiguedadM.pdf", width = w, height = h)
ggplot(LM, aes(x = Identificador, y = Salario)) +
geom_point(aes(color = factor(salirse)))+
labs(x = "Identificador", y = "Salario", color = "Liquidar")+
theme_minimal()
ggsave(filename = "SalarioM.pdf", width = w, height = h)
1029396692+1277540347+149396342807+34038665023
currency(185741944869, digits=0L, symbol = "")
library(formattable)
currency(185741944869, digits=0L, symbol = "")
185,741,944,869+256144960694
185741944869+256144960694
149396342807+254377593806
currency(403773936613, digits=0L, symbol = "")
1029396692+1277540347+149396342807
1029396692+1277540347+149396342807+34038665023
1546923913+220442974+254377593806+56027176299
312172136992+185741944869
2576320605+1497983321+403773936613+90065841320
costo_LiquidacionT - aportes
1 + 1
#| echo: false
2 * 2
p <- seq(0.05, 0.01, (0.05 - 0.01)/50)
p <- seq(0.01, 0.05, length.out = 50)
sigma <- 100
mu <- 1000
p <- seq(0.01, 0.05, length.out = 50)
VaR <- sigma*qnorm(p) + mu
plot(p, VaR)
theta <- 1/100
X <- rexp(1000, theta)
tau <- 2
Y <- Y^tau
theta <- 1/100
X <- rexp(1000, theta)
tau <- 2
Y <- X^tau
hist(Y)
theta <- 1/100
X <- rexp(1000, theta)
tau <- 2
Y <- X^tau
hist(X)
hist(Y)
theta <- 1/100
X <- rexp(1000, theta)
tau <- 2
Y <- X^tau
hist(X)
hist(Y)
theta <- 1/100
X <- rexp(1000, theta)
tau <- 2
Y <- X^(1/tau)
hist(X)
hist(Y)
theta <- 1/100
X <- rexp(1000, theta)
tau <- 2
Y <- X^(tau)
hist(X)
hist(Y)
theta <- 1/100
X <- rexp(1000, theta)
tau <- 3
Y <- X^(tau)
hist(X)
hist(Y)
theta <- 1/100
X <- rexp(1000, theta)
tau <- 1/2
Y <- X^(tau)
hist(X)
hist(Y)
theta <- 1/100
X <- rexp(1000, theta)
tau <- 1/3
Y <- X^(tau)
hist(X)
hist(Y)
theta <- 1/100
X <- rexp(1000, theta)
tau <- 1/10
Y <- X^(tau)
hist(X)
hist(Y)
p3 <- ggplot(data = data.frame(x = c(0,2)), aes(x)) +
stat_function(fun = dweibull, n = 101, args = list(shape = 1/tau,
scale = theta^tau)) +
ylab("") +
scale_y_continuous(breaks = NULL)+
theme_minimal()
library(ggplot2)
p3 <- ggplot(data = data.frame(x = c(0,2)), aes(x)) +
stat_function(fun = dweibull, n = 101, args = list(shape = 1/tau,
scale = theta^tau)) +
ylab("") +
scale_y_continuous(breaks = NULL)+
theme_minimal()
p3
theta <- 1/100
X <- rexp(1000, theta)
tau <- 2
Y <- X^(tau)
hist(X)
hist(Y)
p3 <- ggplot(data = data.frame(x = c(0,2)), aes(x)) +
stat_function(fun = dweibull, n = 101, args = list(shape = 1/tau,
scale = theta^tau)) +
ylab("") +
scale_y_continuous(breaks = NULL)+
theme_minimal()
p3
p3 <- ggplot(data = data.frame(x = c(-2,2)), aes(x)) +
stat_function(fun = dweibull, n = 101, args = list(shape = 1/tau,
scale = theta^tau)) +
ylab("") +
scale_y_continuous(breaks = NULL)+
theme_minimal()
p3
p3 <- ggplot(data = data.frame(x = c(-1,1)), aes(x)) +
stat_function(fun = dweibull, n = 101, args = list(shape = 1/tau,
scale = theta^tau)) +
ylab("") +
scale_y_continuous(breaks = NULL)+
theme_minimal()
p3
p3 <- ggplot(data = data.frame(x = c(-1/2,1/2)), aes(x)) +
stat_function(fun = dweibull, n = 101, args = list(shape = 1/tau,
scale = theta^tau)) +
ylab("") +
scale_y_continuous(breaks = NULL)+
theme_minimal()
p3
p3 <- ggplot(data = data.frame(x = c(-1/10,1/10)), aes(x)) +
stat_function(fun = dweibull, n = 101, args = list(shape = 1/tau,
scale = theta^tau)) +
ylab("") +
scale_y_continuous(breaks = NULL)+
theme_minimal()
p3
p3 <- ggplot(data = data.frame(x = c(-1/20,1/20)), aes(x)) +
stat_function(fun = dweibull, n = 101, args = list(shape = 1/tau,
scale = theta^tau)) +
ylab("") +
scale_y_continuous(breaks = NULL)+
theme_minimal()
p3
p3 <- ggplot(data = data.frame(x = c(0,1/20)), aes(x)) +
stat_function(fun = dweibull, n = 101, args = list(shape = 1/tau,
scale = 1/theta^tau)) +
ylab("") +
scale_y_continuous(breaks = NULL)+
theme_minimal()
p3
p3 <- ggplot(data = data.frame(x = c(0,350000)), aes(x)) +
stat_function(fun = dweibull, n = 101, args = list(shape = 1/tau,
scale = 1/theta^tau)) +
ylab("") +
scale_y_continuous(breaks = NULL)+
theme_minimal()
p3
p3 <- ggplot(data = data.frame(x = c(0,350000)), aes(x)) +
stat_function(fun = dweibull, n = 101, args = list(shape = 1/tau,
scale = theta^tau)) +
ylab("") +
scale_y_continuous(breaks = NULL)+
theme_minimal()
p3
hist(rweibull(1000, 1/tau, theta^tau))
hist(rweibull(1000, 1/tau, 1/theta^tau))
hist(rweibull(1000, 1/tau, 1/theta^tau))
update-tlmgr-latest(.sh/.exe) --update
install.packages(c("bookdown", "bslib", "callr", "cubature", "DT", "dtplyr", "evaluate", "fontawesome", "forcats", "furrr", "future", "ggforce", "globals", "googlesheets4", "gtools", "haven", "hms", "htmltools", "httr", "igraph", "infer", "interp", "knitr", "lessR", "modelr", "np", "parallelly", "parsnip", "patchwork", "pillar", "quantreg", "R.cache", "Rcpp", "RcppArmadillo", "RCurl", "readxl", "reprex", "rlang", "rmarkdown", "rsample", "rstudioapi", "rvest", "sass", "scales", "shiny", "stringi", "stringr", "tibble", "tidymodels", "tidyverse", "timeDate", "tinytex", "tweenr", "viridisLite", "workflowsets", "xfun"))
update-tlmgr-latest(.sh/.exe) --update
install.packages('tlmgr')
install.packages("tlmgr")
install.packages(c("igraph", "Rcpp", "stringi"))
install.packages("tinytex")
update-tlmgr-latest(.sh/.exe) --update
tinytex::reinstall_tinytex()
library(ggplot2)
#| label: fig-scatterplot
#| fig-cap: "City and highway mileage for 38 popular models of cars."
#| fig-alt: "Scatterplot of city vs. highway mileage for cars, where points are colored by the number of cylinders. The plot displays a positive, linear, and strong relationship between city and highway mileage, and mileage increases as the number cylinders decreases."
#| fig-width: 6
#| fig-height: 3.5
ggplot(mpg, aes(x = hwy, y = cty, color = cyl)) +
geom_point(alpha = 0.5, size = 2) +
scale_color_viridis_c() +
theme_minimal()
setwd("~/Perdidas/Proyecto/Proyecto-Distribuciones-de-Perdidas")
read.csv('tsa_claims.csv')
#Se cargan los datos
datos <- read.csv('tsa_claims.csv')
head(datos)
library(janitor)
library(tidyverse)
#Se cargan los datos
datos <- read.csv('tsa_claims.csv') %>% clean_names()
head(datos)
library(lubridate)
